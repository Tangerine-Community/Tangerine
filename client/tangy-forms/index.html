<!doctype html>
<html lang="en">
  <head>

    <link rel="manifest" href="/manifest.json">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <meta name="description" content="tangy description">

    <title>Tangerine Forms</title>


    <script src="node_modules/redux/dist/redux.js"></script>
    <script type="module" src="node_modules/@polymer/paper-progress/paper-progress.js"></script>
    <script type="module" src="src/tangy-form-app/tangy-form-app.js"></script>
    <script type="module" src="global-styles.js"></script>

    <link href="fonts/fonts.css" rel="stylesheet">
    <style>
      body  {
        min-height: 100vh;
        padding: 0px;
        margin: 0px;
        background: #FAFAFA;
      }
     
    </style>

  </head>

  <body>


    <div id="base-path-loader"></div>

    <script>

      function parseQuery(qstr) {
        var query = {};
        var a = (qstr[0] === '#' ? qstr.substr(1) : qstr).split('&');
        for (var i = 0; i < a.length; i++) {
          var b = a[i].split('=');
          query[decodeURIComponent(b[0])] = decodeURIComponent(b[1] || '');
        }
        return query;
      }

      (function() {
        if (window.location.hash) {
          let query = parseQuery(window.location.hash)
          let formPath = query.form 
          let formDirectory = formPath.substring(0, formPath.lastIndexOf('\/')) + '/'
          console.log(`Setting <base> path using form directory: ${formDirectory}`)
          window['base-path-loader'].innerHTML = `<base href="${formDirectory}">`
        }
      })();

    </script>

    <div id="tangy-form-app-loading" style="text-align: center; margin: auto; width: 300px">
      Loading...
      <paper-progress style="margin: auto" indeterminate class="slow"></paper-progress>
    </div>

    <tangy-form-app></tangy-form-app>

  </body>
</html>
