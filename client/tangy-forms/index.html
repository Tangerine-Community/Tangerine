<!doctype html>
<html lang="en">
  <head>

    <link rel="manifest" href="/manifest.json">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <meta name="description" content="tangy description">

    <title>Tangerine Forms</title>

    <script src="bower_components/webcomponentsjs/webcomponents-loader.js"></script>
    <link href="fonts/fonts.css" rel="stylesheet">

    <link rel="import" href="src/tangy-form-app/tangy-form-app.html">

    <link rel="import" href="global-styles.html">
    <style>
      body  {
        min-height: 100vh;
        padding: 0px;
        margin: 0px;
        background: #FAFAFA;
      }
      *[hidden] {
        display: none;
      }
      *[name] {
        border: white solid 3px;
        padding: 5px;
      }
      *[invalid]:not([disabled]):not(tangy-input) {
        border: rgb(252, 177, 177) solid 3px;
      }
      *[required]:not([disabled])  { 
        position: relative;
      }
      *[required]:not([disabled])::before  { 
        content: "*"; 
        color: red; 
        position: absolute;
        top: 4px;
        right: 5px;
      }
    </style>

  </head>

  <body>

    <div id="base-path-loader"></div>

    <script>

      function parseQuery(qstr) {
        var query = {};
        var a = (qstr[0] === '#' ? qstr.substr(1) : qstr).split('&');
        for (var i = 0; i < a.length; i++) {
          var b = a[i].split('=');
          query[decodeURIComponent(b[0])] = decodeURIComponent(b[1] || '');
        }
        return query;
      }

      (function() {
        if (window.location.hash) {
          let query = parseQuery(window.location.hash)
          let formPath = query.form 
          let formDirectory = formPath.substring(0, formPath.lastIndexOf('\/')) + '/'
          console.log(`Setting <base> path using form directory: ${formDirectory}`)
          window['base-path-loader'].innerHTML = `<base href="${formDirectory}">`
        }
      })();

    </script>

    <tangy-form-app></tangy-form-app>

  </body>
</html>
